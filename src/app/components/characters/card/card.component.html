<div class="playerCard" *ngIf="character | async as characterScalar">
  <div class="nameRow">
    <div class="name">
      {{ characterScalar.name }}
    </div>
    <div class="lock">
      <button mat-icon-button (click)="toggleLock($event)"
          *ngIf="(relationship | async) === 'gm'">
        <mat-icon inline="true" class="lockIcon">
          {{ (locked | async) ? 'lock' : 'lock_open'}}
        </mat-icon>
      </button>
    </div>
  </div>
  <div class="characterBody">
    <div class="attributes" *ngIf="characterScalar.subtype !== 'nonplayer'">
      <div *ngFor="let attribute of characterScalar.attributes | keyvalue"
          class="attribute">
        <div class="attributeName">
          {{attribute.value.name}}:
        </div>
        <div *ngIf="attribute.value.wound">
          <mat-icon color="warn">sentiment_very_dissatisfied</mat-icon>
        </div>
        <div class="attributeContent" *ngIf="!attribute.value.wound">
          <adjust-character *ngIf="!(locked|async)" min="0"
              [max]="attribute.value.pool" [increment]="-1"
              [character]="characterScalar"
              [path]="'attributes.'+attribute.key+'.current'">
          </adjust-character>
          <div class="pool">
            {{ attribute.value.current }} / {{attribute.value.pool}}
          </div>
          <adjust-character *ngIf="!(locked|async)" min="0"
              [max]="attribute.value.pool" [increment]="1"
              [character]="characterScalar"
              [path]="'attributes.'+attribute.key+'.current'">
          </adjust-character>
        </div>
      </div>
      <div class="attribute" *ngIf="characterScalar.initiative >= 0">
        <div class="attributeName">Initiative:</div>
        <div class="attributeContent">
          <adjust-character *ngIf="!(locked|async)" min="0" [max]="1000"
              [increment]="0" [character]="character" [path]="'initiative'">
          </adjust-character>
          <div class="pool">{{characterScalar.initiative}}</div>
          <adjust-character *ngIf="!(locked|async)" min="0" [max]="1000"
              [increment]="1" [character]="character" [path]="'initiative'">
          </adjust-character>
        </div>
      </div>
    </div>
    <mat-expansion-panel *ngIf="characterScalar.subtype !== 'nonplayer'">
      <mat-expansion-panel-header>
        <mat-panel-title>Skills</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="skills">
        <div *ngFor="let skill of skills | async" class="skill">
          <div class="skillInfo">
            <div>{{skill.name}}</div>
            <button mat-stroked-button class="skillLevel" color="primary"
                *ngIf="gmOrPlayer | async; else skillLevelOnly"
                (click)="check($event, skill)">
              {{skill.level}}
            </button>
            <ng-template #skillLevelOnly>
              <div class="skillLevel">{{skill.level}}</div>
            </ng-template>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
    <mat-expansion-panel *ngIf="characterScalar.equipment.length > 0">
      <mat-expansion-panel-header>
        <mat-panel-title>Equipment</mat-panel-title>
      </mat-expansion-panel-header>
      <div *ngFor="let item of characterScalar.equipment" class="item">
        <div>
          {{item.name}}
        </div>
        <mat-icon [matTooltip]="item|json">info</mat-icon>
      </div>
    </mat-expansion-panel>
  </div>
</div>