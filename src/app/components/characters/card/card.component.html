<div class="playerCard">
  <div class="nameRow">
    <div class="name">
      {{ character.name }}
    </div>
  </div>
  <div class="characterBody">
    <div *ngFor="let player of activePlayers | async">
      {{ player.name }}
    </div>
    <div class="attributes">
      <div *ngFor="let attribute of attributes | async" class="attribute">
        <div class="attributeName">
          {{attribute.name}}:
        </div>
        <div class="wound" *ngIf="attribute.wound; else unwounded">
          <mat-icon>sentiment_very_dissatisfied</mat-icon>
        </div>
        <ng-template #unwounded>
          <div class="currentPool"
              [ngClass]="attribute.current < 2 ? 'dangerPool' : 'okayPool'">
            {{ attribute.current }}
          </div>
          <div class="maxPool">
            / {{attribute.pool}}
          </div>
        </ng-template>
      </div>
      <div class="attribute" *ngIf="character.status?.initiative >= 0">
        <div class="attributeName">Initiative:</div>
        <div class="currentPool">{{character.status.initiative}}</div>
      </div>
    </div>
    <div
        *ngIf="expanded && character.type !== 'nonplayer' && (character.skills | keyvalue)?.length > 0">
      <div>Skills</div>
      <div class="skills">
        <div *ngFor="let skill of skills | async" class="skill">
          <div class="skillInfo">
            {{skill.name}}: {{skill.levelName}}
          </div>
          <div *ngIf="(viewerIsGM | async) || (viewerIsActivePlayer | async)">
            <button mat-icon-button [matMenuTriggerFor]="menu"
                aria-label="Example icon-button with a menu">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <button mat-menu-item>
                <mat-icon>casino</mat-icon>
                <span>Roll</span>
              </button>
            </mat-menu>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>